prompt = PromptTemplate(
    input_variables=["source"],
    template="""
Analyze the following Java source code and return JSON with:
- class_name
- class_type: one of exactly ["Controller", "Service", "Repository", "Config", "Entity", "DTO", "Main"]. 
  ⚠️ Map annotations correctly:
    - If annotated with @RestController or @Controller → class_type = "Controller"
    - If annotated with @Service → class_type = "Service"
    - If annotated with @Repository → class_type = "Repository"
    - If annotated with @Entity or @Table → class_type = "Entity"
    - If class name ends with DTO → class_type = "DTO"
    - If class has main method → class_type = "Main"
- package_path
- methods: list of public method signatures (include parameter types & return type)
- uses_repository: true if this class has any field or constructor parameter whose type ends with 'Repository'

If class_type is "Entity" or "DTO", also include:
- entity_fields: list of {{"name": fieldName, "type": fieldType}}

⚠️ Always extract ALL fields (private/public) from entities/DTOs.
⚠️ Always normalize class_type to exactly one of the allowed values above.
Return compact valid JSON only. No explanation.

Java Source:
{source}
"""
)
